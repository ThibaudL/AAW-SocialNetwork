<ui:composition 
    xmlns="http://www.w3.org/1999/xhtml"
    xmlns:f="http://java.sun.com/jsf/core"
    xmlns:h="http://java.sun.com/jsf/html"
    xmlns:ui="http://java.sun.com/jsf/facelets"
    xmlns:p="http://primefaces.org/ui">
    
    <div id="ohsnap"></div>

    <script>
        var wsUri = "ws://" + document.location.host + "/SocialNetwork-war/mediatorendpoint/"+#{ProfileMB.profile.user.id};
        var websocket = new WebSocket(wsUri);

        websocket.onmessage = function(evt){
            console.log("received : " + evt.data);
            var obj = jQuery.parseJSON(evt.data);
            console.log("JSON " + obj);
            ohSnap(obj.content, 'blue');
            var ul = document.getElementById("notification-list");
            var li = document.createElement("li");
            var a = document.createElement("a");
            a.setAttribute("href",obj.link);
            li.setAttribute("class","li-notification");
            a.appendChild(document.createTextNode(obj.content));
            a.setAttribute("class","btn-block");
            li.appendChild(a);
            ul.appendChild(li);
            
            var spanNumber = document.getElementById("notification-numbers").innerHTML;
            var newSpanNumber = parseInt(spanNumber, 10) +1;
            document.getElementById("notification-numbers").innerHTML = newSpanNumber;
        };

        websocket.onerror = function(evt){
            console.log("Error : " + evt.data);
        };

        websocket.onopen = function(evt){
            console.log("Open : " + evt);
        };

        
    </script>
</ui:composition>